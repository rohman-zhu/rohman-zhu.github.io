<!DOCTYPE html>
<html lang="zh_cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"github.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="诺曼实验室">
<meta property="og:url" content="http://github.com/rohman-zhu/page/28/index.html">
<meta property="og:site_name" content="诺曼实验室">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Rohman.Zhu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://github.com/rohman-zhu/page/28/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh_cn","comments":"","permalink":"","path":"page/28/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>诺曼实验室</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">诺曼实验室</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Rohman.Zhu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">452</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">148</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/609bc2a3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/609bc2a3/" class="post-title-link" itemprop="url">GIT+HEXO快速部署</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-03-15 21:56:34" itemprop="dateCreated datePublished" datetime="2020-03-15T21:56:34+00:00">2020-03-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:47" itemprop="dateModified" datetime="2024-12-22T05:27:47+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><table>
<thead>
<tr>
<th align="center">Iten</th>
<th align="center">Detail</th>
</tr>
</thead>
<tbody><tr>
<td align="center">OS</td>
<td align="center">CentOS 7</td>
</tr>
<tr>
<td align="center">Kernel</td>
<td align="center">Linux 3.10.0-862.el7.x86_64</td>
</tr>
<tr>
<td align="center">Node version</td>
<td align="center">13.9.0</td>
</tr>
<tr>
<td align="center">npm version</td>
<td align="center">6.13.7</td>
</tr>
<tr>
<td align="center">hexo version</td>
<td align="center">4.2.0</td>
</tr>
<tr>
<td align="center">Git version</td>
<td align="center">1.8.3.1</td>
</tr>
</tbody></table>
<h1 id="一、安装与配置-git"><a href="#一、安装与配置-git" class="headerlink" title="一、安装与配置 git"></a>一、安装与配置 git</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install git-core -y</span><br><span class="line">git --version</span><br><span class="line"></span><br><span class="line">git --global user.name <span class="string">&quot;r0manj&quot;</span></span><br><span class="line">git --global user.email <span class="string">&quot;zhur0ngjian@126.com&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="二、安装-node-js"><a href="#二、安装-node-js" class="headerlink" title="二、安装 node.js"></a>二、安装 node.js</h1><p>使用yum安装只会安装到老版本，直接到官网下载最新的源码包，采用源码安装。</p>
<p>官网：<a target="_blank" rel="noopener" href="http://nodejs.cn/download/">http://nodejs.cn/download/</a><br>淘宝镜像：<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/node/">https://npm.taobao.org/mirrors/node/</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压安装包</span></span><br><span class="line">tar xvf node-v13.9.0-linux-x64.tar</span><br><span class="line"><span class="comment"># 将安装包拷贝到 /usr/local/node-13.9.0目录下。（略）</span></span><br><span class="line"><span class="comment"># 将bin目录的可执行文件添加到环境变量中</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export PATH=<span class="variable">$PATH</span>:/usr/local/node-13.9.0/bin&quot;</span> &gt;&gt; /etc/profile</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"><span class="comment"># 配置国内npm镜像源</span></span><br><span class="line">npm config <span class="built_in">set</span> registry http://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>

<h1 id="三、安装hexo"><a href="#三、安装hexo" class="headerlink" title="三、安装hexo"></a>三、安装hexo</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure>

<h1 id="四、创建GitHub代码仓库与初始化hexo博客"><a href="#四、创建GitHub代码仓库与初始化hexo博客" class="headerlink" title="四、创建GitHub代码仓库与初始化hexo博客"></a>四、创建GitHub代码仓库与初始化hexo博客</h1><p>GITHUB创建代码仓库（略）</p>
<p>创建空目录后执行初始化操作</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line"></span><br><span class="line">npm install --save hexo-deployer-git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成标签页和目录页</span></span><br><span class="line">hexo new page tags</span><br><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure>

<blockquote>
<p>需要在tags和categories的页面里添加属性，type:”tags” 、type:”categories”</p>
</blockquote>
<p>配置hexo的 _config.yml 文件，设置git的相关账号。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:R0manJ/R0manJ.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<h1 id="五、到GitHub上的仓库添加这台服务器的ssh-key"><a href="#五、到GitHub上的仓库添加这台服务器的ssh-key" class="headerlink" title="五、到GitHub上的仓库添加这台服务器的ssh-key"></a>五、到GitHub上的仓库添加这台服务器的ssh-key</h1><p>到仓库的setting界面，进入Deploy keys，点击 “Add deploy key”，将服务器的公钥添加进去。</p>
<h1 id="六、其他操作"><a href="#六、其他操作" class="headerlink" title="六、其他操作"></a>六、其他操作</h1><h2 id="配置samba服务"><a href="#配置samba服务" class="headerlink" title="配置samba服务"></a>配置samba服务</h2><p>可以部署samba服务将post文件夹共享出来。</p>
<h2 id="防火墙配置"><a href="#防火墙配置" class="headerlink" title="防火墙配置"></a>防火墙配置</h2><p>图省事就关闭了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewal-cmd --state</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huay/p/11266803.html">https://www.cnblogs.com/huay/p/11266803.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/tian330726/article/details/80791388">https://blog.csdn.net/tian330726/article/details/80791388</a></p>
<p>samba服务-1：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u013230234/article/details/81639801">https://blog.csdn.net/u013230234/article/details/81639801</a></p>
<p>samba服务-2：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41078837/article/details/80570693">https://blog.csdn.net/weixin_41078837/article/details/80570693</a></p>
<p>CentOS7防火墙操作相关：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xxoome/p/7115614.html">https://www.cnblogs.com/xxoome/p/7115614.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/14cc785a/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/14cc785a/" class="post-title-link" itemprop="url">AD服务器防火墙端口整理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-03-15 20:46:00" itemprop="dateCreated datePublished" datetime="2020-03-15T20:46:00+00:00">2020-03-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:47" itemprop="dateModified" datetime="2024-12-22T05:27:47+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Windows-Server/" itemprop="url" rel="index"><span itemprop="name">Windows Server</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>If you are working on Active Directory environment and have domain joined systems that needs access to Active Directory that are on different or isolated networks separated by Firewall then you need to allow multiple Active Directory ports to pass through the Firewall. Below are the ports that I have validated and needs to be allowed for smooth member server &#x2F; workstation and AD Communication, as well as for replication -</p>
<h1 id="端口列表"><a href="#端口列表" class="headerlink" title="端口列表"></a>端口列表</h1><table>
<thead>
<tr>
<th align="center">Port Description</th>
<th align="center">Port Details</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Kerberos</td>
<td align="center">TCP-88,UDP-88</td>
</tr>
<tr>
<td align="center">DNS</td>
<td align="center">TCP-53,UDP-53</td>
</tr>
<tr>
<td align="center">Global Catalog</td>
<td align="center">TCP-3268</td>
</tr>
<tr>
<td align="center">Global Catalog（Secure）</td>
<td align="center">TCP-3269</td>
</tr>
<tr>
<td align="center">LDAP</td>
<td align="center">TCP-389，UDP-389</td>
</tr>
<tr>
<td align="center">LDAP（Secure）</td>
<td align="center">TCP-636</td>
</tr>
<tr>
<td align="center">RPC&#x2F;Replication</td>
<td align="center">TCP -135</td>
</tr>
<tr>
<td align="center">Time Service</td>
<td align="center">UDP-123</td>
</tr>
<tr>
<td align="center">Replication, User &#x2F; Computer Authentication, Trusts and Group PolicyNetLogon, NetBIOS name ResolutionDFS , NetLogon</td>
<td align="center">TCP-49152 to 65535,UDP-49152 to 65535</td>
</tr>
<tr>
<td align="center">Kerberos Password Change</td>
<td align="center">TCP-464,UDP-464</td>
</tr>
<tr>
<td align="center">SMB(File Sharing)</td>
<td align="center">TCP-139,445</td>
</tr>
<tr>
<td align="center">DFSR</td>
<td align="center">TCP-5722</td>
</tr>
</tbody></table>
<h2 id="Replication"><a href="#Replication" class="headerlink" title="Replication"></a>Replication</h2><p>Replication uses the remote procedure call (RPC) transport. Replication connections can be created between any two domain controllers located in the same site. Connections can be made with multiple domain controllers to reduce replication latency.</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://gallery.technet.microsoft.com/Active-Directory-Firewall-bd21b246">https://gallery.technet.microsoft.com/Active-Directory-Firewall-bd21b246</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/f70ae926/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/f70ae926/" class="post-title-link" itemprop="url">Exchange CU23升级日志</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-03-08 15:28:40" itemprop="dateCreated datePublished" datetime="2020-03-08T15:28:40+00:00">2020-03-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:47" itemprop="dateModified" datetime="2024-12-22T05:27:47+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最新的Exchange Server需要安装补丁KB4536988，而这个补丁需要升级至CU23才可安装，然而我们的服务器版本为CU21。因此，服务器需要做一遍升级操作才可安装补丁。</p>
<p>主要流程：</p>
<ol>
<li>安装 dot net 4.7.2</li>
<li>安装 CU23 </li>
<li>安装补丁 KB-4536988</li>
</ol>
<h1 id="前端服务器升级"><a href="#前端服务器升级" class="headerlink" title="前端服务器升级"></a>前端服务器升级</h1><p>升级步骤：</p>
<table>
<thead>
<tr>
<th align="center">步骤</th>
<th align="center">任务</th>
<th align="left">详情</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">备份OWA自定义文件</td>
<td align="left">Exchange Server\V15\Frontend\HttpProxy\版本号\themes</td>
<td align="center">CAS 前端服务器</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">备份OWA自定义文件</td>
<td align="left">Exchange Server\V15\Frontend\HttpProxy\OWA\Auth\logon.aspx</td>
<td align="center">CAS 前端服务器</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">安装 dot Net 4.7.2</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">安装CU23</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">安装KB-4536988</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">验证测试</td>
<td align="left">见前端测试流程</td>
<td align="center"></td>
</tr>
</tbody></table>
<blockquote>
<p>为了避免出错，可以管理员身份运行安装包，可以使用 CMD（以管理员身份运行）。</p>
</blockquote>
<p>测试流程：</p>
<ol>
<li>修改hosts文件，将邮件服务器域名解析指向目标前端服务器；</li>
<li>测试 OWA 的邮件收发情况（内网、外网均测试一下）</li>
<li>新建用户邮件 profile 文件 ，使用新profile文件进行邮件收发测试</li>
</ol>
<h1 id="后端服务器升级"><a href="#后端服务器升级" class="headerlink" title="后端服务器升级"></a>后端服务器升级</h1><table>
<thead>
<tr>
<th align="center">步骤</th>
<th align="center">任务</th>
<th align="left">详情</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">备份Web.config文件</td>
<td align="left">Exchange Server\Bin\EdgeTransport.exe.config</td>
<td align="center">后端服务器</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">将DAG中的邮箱服务器切换到维护模式</td>
<td align="left">见下列操作步骤</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">安装 dot Net 4.7.2</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">安装CU23</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">安装KB-4536988</td>
<td align="left">以管理员身份运行安装包，安装完后重启服务器</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">将邮箱服务器退出维护模式</td>
<td align="left">见下列操作步骤</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">检查服务</td>
<td align="left">见下列操作步骤</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>进入维护模式：</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 定义本机主机名变量</span></span><br><span class="line"><span class="variable">$Computer</span> = <span class="variable">$ENV:ComputerName</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 排空邮箱服务器上的所有传送队列的活动邮件，同时传输这些邮件到另外一台服务器上。</span></span><br><span class="line">Redirect<span class="literal">-Message</span> <span class="literal">-Server</span> <span class="variable">$Computer</span> <span class="literal">-Target</span> [<span class="type">DAG</span>的伙伴服务器<span class="type">FQDN</span>名]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 传输组件设置维护模式</span></span><br><span class="line"><span class="built_in">Set-ServerComponentState</span> <span class="variable">$Computer</span> <span class="literal">-Component</span> HubTransport <span class="literal">-State</span> Draining <span class="literal">-Requester</span> Maintenance</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 重启Exchange传输服务</span></span><br><span class="line"><span class="built_in">Restart-Service</span> MSExchangeTransport</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 暂停此群集节点</span></span><br><span class="line"><span class="built_in">Suspend-ClusterNode</span> <span class="variable">$Computer</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 设置迁移活动数据库不能回到当前数据库</span></span><br><span class="line"><span class="built_in">Set-MailboxServer</span> <span class="variable">$Computer</span> <span class="literal">-DatabaseCopyActivationDisabledAndMoveNow</span> <span class="variable">$True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 设置自动切换数据库策略为阻止</span></span><br><span class="line"><span class="built_in">Set-MailboxServer</span> <span class="variable">$Computer</span> <span class="literal">-DatabaseCopyAutoActivationPolicy</span> Blocked</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. 将服务器设置到维护模式</span></span><br><span class="line"><span class="built_in">Set-ServerComponentState</span> <span class="variable">$Computer</span> <span class="literal">-Component</span> ServerWideOffline <span class="literal">-State</span> Inactive <span class="literal">-Requester</span> Maintenance</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9. 查询所有服务器状态，所有组件必须为 “inactive” 状态 。（除了Monitoring 和 RecoveryActionsEnabled）</span></span><br><span class="line"><span class="built_in">Get-ServerComponentState</span> <span class="variable">$Computer</span> | <span class="built_in">ft</span> Component,State <span class="literal">-Autosize</span></span><br></pre></td></tr></table></figure>

<p>退出维护模式：</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 定义本机主机名变量</span></span><br><span class="line"><span class="variable">$Computer</span> = <span class="variable">$ENV:ComputerName</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 恢复传输组件状态</span></span><br><span class="line"><span class="built_in">Set-ServerComponentState</span> <span class="variable">$Computer</span> <span class="literal">-Component</span> ServerWideOffline <span class="literal">-State</span> Active <span class="literal">-Requester</span> Maintenance</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 恢复此群集节点</span></span><br><span class="line"><span class="built_in">Resume-ClusterNode</span> <span class="variable">$Computer</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 手动切换数据库状态</span></span><br><span class="line"><span class="built_in">Set-MailboxServer</span> <span class="variable">$Computer</span> <span class="literal">-DatabaseCopyActivationDisabledAndMoveNow</span> <span class="variable">$False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 设置自动切换数据库策略为不受限制</span></span><br><span class="line"><span class="built_in">Set-MailboxServer</span> <span class="variable">$Computer</span> <span class="literal">-DatabaseCopyAutoActivationPolicy</span> Unrestricted</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 传输服务器设置维护状态</span></span><br><span class="line"><span class="built_in">Set-ServerComponentState</span> <span class="variable">$Computer</span> <span class="literal">-Component</span> HubTransport <span class="literal">-State</span> Active <span class="literal">-Requester</span> Maintenance</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 重启Exchange传输服务</span></span><br><span class="line"><span class="built_in">Restart-Service</span> MSExchangeTransport</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. 查询所有服务器状态，所有组件必须为 “inactive” 状态 。（除了Monitoring 和 RecoveryActionsEnabled）</span></span><br><span class="line"><span class="built_in">Get-ServerComponentState</span> <span class="variable">$Computer</span> | <span class="built_in">ft</span> Component,State <span class="literal">-Autosize</span></span><br></pre></td></tr></table></figure>

<h2 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h2><p>一、 IIS导致的故障</p>
<p>解决方法：</p>
<ol>
<li>verify you have several gigs free disk space on C drive of the server being upgraded</li>
<li>Stop the IISADMIN service and World Wide Web Services</li>
<li>Make sure the account your using to run the installer is member of schema admins, domain admins and exchange organization management</li>
<li>Run the upgrade again, but this time, right click the install file and click ‘run as administrator’</li>
</ol>
<p>参考：<a target="_blank" rel="noopener" href="https://enterpriseit.co/microsoft-exchange/2013/error-cu-upgrade-system-management-automation-remoteexception/">https://enterpriseit.co/microsoft-exchange/2013/error-cu-upgrade-system-management-automation-remoteexception/</a></p>
<p>二、 安装CU23出现错误 “ Setup can’t continue with the upgrade because the monad(7688) …mscorsvw (14664) has open files. Close the process, and then restart Setup. For more information, visit: <a target="_blank" rel="noopener" href="http://technet.microsoft.com/library(EXCHG.150)/ms.exch.setupreadiness.ProcessNeedsToBeClosedOnUpgrade.aspx">http://technet.microsoft.com/library(EXCHG.150)/ms.exch.setupreadiness.ProcessNeedsToBeClosedOnUpgrade.aspx</a> ”</p>
<ul>
<li><p>关于 mscorsvw（14664） 是一个 .net 相关的进程，可能net4.7.2没有安装成功。</p>
</li>
<li><p>参考：<a target="_blank" rel="noopener" href="https://www.concurrency.com/blog/w/exchange-2013-cu-installation-setup-can-t-continue">https://www.concurrency.com/blog/w/exchange-2013-cu-installation-setup-can-t-continue</a></p>
</li>
<li><p>关于monad（7688）是一个powershell的进程，但这是跟NetBackup备份服务相关的进程冲突导致的，需要关闭相关服务。</p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/7f128923/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/7f128923/" class="post-title-link" itemprop="url">查询已安装的dotNet版本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-03-07 22:55:26" itemprop="dateCreated datePublished" datetime="2020-03-07T22:55:26+00:00">2020-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/4632a71a/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/4632a71a/" class="post-title-link" itemprop="url">Ubuntu 18.04修改网卡</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-03-05 23:27:09" itemprop="dateCreated datePublished" datetime="2020-03-05T23:27:09+00:00">2020-03-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="How-to-configure-static-ip"><a href="#How-to-configure-static-ip" class="headerlink" title="How to configure static ip"></a>How to configure static ip</h1><p>To configure a static IP address on your Ubuntu 18.04 server you need to modify a relevant netplan network configuration file within &#x2F;etc&#x2F;netplan&#x2F; directory.</p>
<p>For example you might find there a default netplan configuration file called 01-netcfg.yaml or 50-cloud-init.yaml with a following content instructing the networkd deamon to configure your network interface via DHCP:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This file describes the network interfaces available on your system</span></span><br><span class="line"><span class="comment"># For more information, see netplan(5).</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">renderer:</span> <span class="string">networkd</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">enp0s3:</span></span><br><span class="line">      <span class="attr">dhcp4:</span> <span class="literal">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This file describes the network interfaces available on your system</span></span><br><span class="line"><span class="comment"># For more information, see netplan(5).</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">renderer:</span> <span class="string">networkd</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">enp0s3:</span></span><br><span class="line">     <span class="attr">dhcp4:</span> <span class="literal">no</span></span><br><span class="line">     <span class="attr">addresses:</span> [<span class="number">192.168</span><span class="number">.1</span><span class="number">.222</span><span class="string">/24</span>]</span><br><span class="line">     <span class="attr">gateway4:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">     <span class="attr">nameservers:</span></span><br><span class="line">       <span class="attr">addresses:</span> [<span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span>,<span class="number">8.8</span><span class="number">.4</span><span class="number">.4</span>]</span><br></pre></td></tr></table></figure>

<h1 id="修改完后"><a href="#修改完后" class="headerlink" title="修改完后"></a>修改完后</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netplan apply</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://linuxconfig.org/how-to-configure-static-ip-address-on-ubuntu-18-04-bionic-beaver-linux">https://linuxconfig.org/how-to-configure-static-ip-address-on-ubuntu-18-04-bionic-beaver-linux</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/1378e6abd94d">https://www.jianshu.com/p/1378e6abd94d</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/ca72b0f2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/ca72b0f2/" class="post-title-link" itemprop="url">Exchange Management Shell 指令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-03-01 23:21:53" itemprop="dateCreated datePublished" datetime="2020-03-01T23:21:53+00:00">2020-03-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:47" itemprop="dateModified" datetime="2024-12-22T05:27:47+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Move-ActiveMailboxDatabase"><a href="#Move-ActiveMailboxDatabase" class="headerlink" title="Move-ActiveMailboxDatabase"></a>Move-ActiveMailboxDatabase</h1><figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example 1:</span></span><br><span class="line"><span class="built_in">Move-ActiveMailboxDatabase</span> <span class="literal">-Server</span> MBX1</span><br><span class="line"></span><br><span class="line"><span class="comment"># This example performs a server switchover for the Mailbox server MBX1. All active mailbox database copies on MBX1 will be activated on one or more other Mailbox servers with healthy copies of the active databases on MBX1.</span></span><br></pre></td></tr></table></figure>

<p>参考： <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/move-activemailboxdatabase?view=exchange-ps">https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/move-activemailboxdatabase?view=exchange-ps</a></p>
<h1 id="Get-MailboxDatabaseCopyStatus"><a href="#Get-MailboxDatabaseCopyStatus" class="headerlink" title="Get-MailboxDatabaseCopyStatus"></a>Get-MailboxDatabaseCopyStatus</h1><p>Use the Get-MailboxDatabaseCopyStatus cmdlet to view health and status information about one or more mailbox database copies.</p>
<p>参考：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/get-mailboxdatabasecopystatus?view=exchange-ps">https://docs.microsoft.com/en-us/powershell/module/exchange/database-availability-groups/get-mailboxdatabasecopystatus?view=exchange-ps</a></p>
<h1 id="Test-ServerHealth"><a href="#Test-ServerHealth" class="headerlink" title="Test-ServerHealth"></a>Test-ServerHealth</h1><p>Use the Test-ServiceHealth cmdlet to test whether all the Microsoft Windows services that Exchange requires on a server have started. The Test-ServiceHealth cmdlet returns an error for any service required by a configured role when the service is set to start automatically and isn’t currently running.</p>
<p>参考：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/module/exchange/server-health-and-performance/test-servicehealth">https://docs.microsoft.com/en-us/powershell/module/exchange/server-health-and-performance/test-servicehealth</a></p>
<h1 id="Test-MAPIConnectivity"><a href="#Test-MAPIConnectivity" class="headerlink" title="Test-MAPIConnectivity"></a>Test-MAPIConnectivity</h1><p>Use the Test-MapiConnectivity cmdlet to verify server functionality by logging on to the mailbox that you specify. If you don’t specify a mailbox, the cmdlet logs on to the SystemMailbox on the database that you specify.</p>
<p>参考：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/test-mapiconnectivity?view=exchange-ps">https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/test-mapiconnectivity?view=exchange-ps</a></p>
<h1 id="Get-ExchangeServer"><a href="#Get-ExchangeServer" class="headerlink" title="Get-ExchangeServer"></a>Get-ExchangeServer</h1><p>Use the Get-ExchangeServer cmdlet to view the properties of Exchange servers.</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ExchangeServer</span> | <span class="built_in">ft</span> Name,Edition,AdminDisplayVersion</span><br><span class="line"></span><br><span class="line"><span class="comment"># Exchange CU23 (Cumulative Updates 23),Version is 15.0.0.1497.002</span></span><br><span class="line"><span class="comment"># https://www.microsoft.com/en-us/download/details.aspx?id=58392</span></span><br><span class="line"><span class="comment"># Require： DotNet4.7.2</span></span><br></pre></td></tr></table></figure>

<p>参考：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/powershell/module/exchange/organization/Get-ExchangeServer">https://docs.microsoft.com/en-us/powershell/module/exchange/organization/Get-ExchangeServer</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/95720037/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/95720037/" class="post-title-link" itemprop="url">Ubuntu因显卡驱动问题无法进入系统</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-02-25 15:42:11" itemprop="dateCreated datePublished" datetime="2020-02-25T15:42:11+00:00">2020-02-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障现象"><a href="#故障现象" class="headerlink" title="故障现象"></a>故障现象</h1><p>无法进入图形界面，重复输入密码。<br>进入命令行界面，查看xsession-error日志</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">name of display: :0</span><br><span class="line">X Error of failed request:  BadValue (integer parameter out of range for operation)</span><br><span class="line">Major opcode of failed request:  154 (GLX)</span><br><span class="line">Minor opcode of failed request:  24 (X_GLXCreateNewContext)</span><br><span class="line">Value in failed request:  0x0</span><br><span class="line">Serial number of failed request:  30</span><br><span class="line">Current serial number in output stream:  31</span><br><span class="line"></span><br><span class="line">openConnection:connect:No such file or directory</span><br><span class="line">cannot connect to britty at :0</span><br></pre></td></tr></table></figure>

<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><h1 id=""><a href="#" class="headerlink" title=""></a></h1>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/fc6e93c0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/fc6e93c0/" class="post-title-link" itemprop="url">Ubuntu配置VNC</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-02-25 15:20:13" itemprop="dateCreated datePublished" datetime="2020-02-25T15:20:13+00:00">2020-02-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/dd2cc47f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/dd2cc47f/" class="post-title-link" itemprop="url">安装完vnc后Ubuntu无法登录</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-02-25 13:04:48" itemprop="dateCreated datePublished" datetime="2020-02-25T13:04:48+00:00">2020-02-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障现象"><a href="#故障现象" class="headerlink" title="故障现象"></a>故障现象</h1><p>在Ubuntu图形界面，反复输入账户密码，无法进入系统。</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>进入用户目录，查看 .xsession-errors 文件，发现有 permission denail 字样</p>
<p>根本原因： ~&#x2F;.ICEauthority 和 ~&#x2F;.Xauthority 的owner被改成root<br>间接原因： sudo vncserver（在root账户下执行vncserver）</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>通过命令终端进入（ctrl + alt + F2） 将用户文件夹下的 ~&#x2F;.ICEauthority 和 ~&#x2F;.Xauthority 用户权限改为普通用户后，重启即可。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/c33664cb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/c33664cb/" class="post-title-link" itemprop="url">Linux-IP命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-02-21 23:15:25" itemprop="dateCreated datePublished" datetime="2020-02-21T23:15:25+00:00">2020-02-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h1 id="ip-ad"><a href="#ip-ad" class="headerlink" title="ip ad"></a>ip ad</h1><p>新的命名方案被称为“可预测的网络接口Predictable Network Interface”。 它已经在基于systemd 的 Linux 系统上使用了一段时间了。 接口名称取决于硬件的物理位置。 en 仅仅就是 “ethernet” 的意思，就像 “eth” 用于对应 eth0，一样。 p 是以太网卡的总线编号，s 是插槽编号。 所以 enp0s25 告诉我们很多我们正在使用的硬件的信息。</p>
<h2 id="信息解读"><a href="#信息解读" class="headerlink" title="信息解读"></a>信息解读</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">BROADCAST   该接口支持广播</span><br><span class="line">MULTICAST   该接口支持多播</span><br><span class="line">UP          网络接口已启用</span><br><span class="line">LOWER_UP    网络电缆已插入，设备已连接至网络</span><br><span class="line"></span><br><span class="line">mtu 1500                                    最大传输单位（数据包大小）为1,500字节</span><br><span class="line">qdisc pfifo_fast                            用于数据包排队</span><br><span class="line">state UP                                    网络接口已启用</span><br><span class="line">group default                               接口组</span><br><span class="line">qlen 1000                                   传输队列长度</span><br><span class="line">link/ether 00:1e:4f:c8:43:fc                接口的 MAC（硬件）地址</span><br><span class="line">brd ff:ff:ff:ff:ff:ff                       广播地址</span><br><span class="line">inet 192.168.0.24/24                        IPv4 地址</span><br><span class="line">brd 192.168.0.255                           广播地址</span><br><span class="line">scope global                                全局有效</span><br><span class="line">dynamic enp0s25                             地址是动态分配的</span><br><span class="line">valid_lft 80866sec                          IPv4 地址的有效使用期限</span><br><span class="line">preferred_lft 80866sec                      IPv4 地址的首选生存期</span><br><span class="line">inet6 fe80::2c8e:1de0:a862:14fd/64          IPv6 地址</span><br><span class="line">scope link                                  仅在此设备上有效</span><br><span class="line">valid_lft forever                           IPv6 地址的有效使用期限</span><br><span class="line">preferred_lft forever                       IPv6 地址的首选生存期</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://linux.cn/article-9476-1.html">https://linux.cn/article-9476-1.html</a><br><a target="_blank" rel="noopener" href="https://linux.cn/article-9704-1.html">https://linux.cn/article-9704-1.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/27/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/27/">27</a><span class="page-number current">28</span><a class="page-number" href="/page/29/">29</a><span class="space">&hellip;</span><a class="page-number" href="/page/46/">46</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/29/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Rohman.Zhu</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":"light","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.min.js","integrity":"sha256-G8ouPAnw4zzMbnAenHnVz6h9XpKbNdOkrqTh7AadyHs="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
