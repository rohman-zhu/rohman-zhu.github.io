<!DOCTYPE html>
<html lang="zh_cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"github.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="诺曼实验室">
<meta property="og:url" content="http://github.com/rohman-zhu/page/25/index.html">
<meta property="og:site_name" content="诺曼实验室">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Rohman.Zhu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://github.com/rohman-zhu/page/25/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh_cn","comments":"","permalink":"","path":"page/25/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>诺曼实验室</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">诺曼实验室</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Rohman.Zhu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">441</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">145</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/332656a6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/332656a6/" class="post-title-link" itemprop="url">记一次光模块导致的故障</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-25 00:31:49" itemprop="dateCreated datePublished" datetime="2020-11-25T00:31:49+00:00">2020-11-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/default/" itemprop="url" rel="index"><span itemprop="name">default</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><ul>
<li>OS做Bond始终无法与交换机协商成功。</li>
<li>OS单独的网口配置完成后，无法ping通网关。</li>
<li>交换机上面能看到端口启用，但是无法看到协商成功的表述或者MAC地址。</li>
<li>光模块外观看到发射光信号正常。</li>
<li>OS上面看到接口是linked的状态。</li>
</ul>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>间接原因: 跟换模块后恢复<br>根本原因：未知</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><p>更换其他模块使用即可。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/3c7feca1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/3c7feca1/" class="post-title-link" itemprop="url">RHEL7.5无法启动问题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-07-30 00:56:07" itemprop="dateCreated datePublished" datetime="2020-07-30T00:56:07+00:00">2020-07-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><ol>
<li>启动进入紧急模式 dracut</li>
<li>提示找不到 root 所在的lv</li>
</ol>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>未知</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><ol>
<li>进入恢复模式</li>
<li>执行以下指令</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dracut -f</span><br><span class="line">grub2-mkconfing</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/f3892bbe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/f3892bbe/" class="post-title-link" itemprop="url">记一次IO引起的故障</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-06-14 14:35:40" itemprop="dateCreated datePublished" datetime="2020-06-14T14:35:40+00:00">2020-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Windows-Server/" itemprop="url" rel="index"><span itemprop="name">Windows Server</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障现象"><a href="#故障现象" class="headerlink" title="故障现象"></a>故障现象</h1><ul>
<li>用户反馈应用访问特别慢。</li>
<li>Windows Server中查看的磁盘IO状态，看到数据库相关的进程Response Time(ms)达到200以上。</li>
<li>在虚拟化监控平台vRealize中查看虚拟磁盘总IO延迟：<ul>
<li>总IOPS达到 10000 + ；</li>
</ul>
</li>
</ul>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>服务器的IO过高，底层没有来得及处理IO请求，新的IO请求已进入，因此导致高延迟。</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>找到IO的瓶颈，逐个扩容:</p>
<ol>
<li>硬件层调整，UCS的刀片IO更改默认值。</li>
<li>虚拟化层调整，改用PV SCSI</li>
<li>操作系统层注册此SCSI控住器：</li>
</ol>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add HKLM\SYSTEM\CurrentControlSet\services\pvscsi\Parameters\Device / DriverParameter /t REG_SZ /d &quot;RequestRingPages=<span class="number">32</span>,MaxQueueDepth=<span class="number">254</span>&quot;</span><br></pre></td></tr></table></figure>

<h1 id="补充："><a href="#补充：" class="headerlink" title="补充："></a>补充：</h1><h2 id="pvscsi-的-IO是多少？"><a href="#pvscsi-的-IO是多少？" class="headerlink" title="pvscsi 的 IO是多少？"></a>pvscsi 的 IO是多少？</h2><p>参考资料 ： </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blogs.vmware.com/vsphere/2014/03/pvscsi-large-ios.html">https://blogs.vmware.com/vsphere/2014/03/pvscsi-large-ios.html</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_34054866/article/details/85184550">https://blog.csdn.net/weixin_34054866/article/details/85184550</a></li>
<li><a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/1017652">https://kb.vmware.com/s/article/1017652</a></li>
<li><a target="_blank" rel="noopener" href="https://blogs.vmware.com/performance/2010/02/highperformance-pvsci-storage-adapter-can-reduce-cpio-by-1030.html">https://blogs.vmware.com/performance/2010/02/highperformance-pvsci-storage-adapter-can-reduce-cpio-by-1030.html</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/dec6a912/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/dec6a912/" class="post-title-link" itemprop="url">CentOS7绑定Bond</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-06-07 13:04:56" itemprop="dateCreated datePublished" datetime="2020-06-07T13:04:56+00:00">2020-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:47" itemprop="dateModified" datetime="2024-12-22T05:27:47+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/CentOS/" itemprop="url" rel="index"><span itemprop="name">CentOS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h1><ol>
<li>sudo 或者 root 权限下操作。</li>
<li>关闭NetworkManager （systemctl disable NetworkManager)</li>
<li>配置DNS（&#x2F;etc&#x2F;resolv.conf)</li>
<li>加载bonding模块（modprobe bonding）</li>
<li>设置网卡配置文件。</li>
</ol>
<h2 id="创建bond0网卡配置文件"><a href="#创建bond0网卡配置文件" class="headerlink" title="创建bond0网卡配置文件"></a>创建bond0网卡配置文件</h2><p>vim &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-bond0</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=bond0</span><br><span class="line">Type=Bond</span><br><span class="line">NAME=bond0</span><br><span class="line">BONDING_ASTER=yes</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.1.1</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=192.168.1.254</span><br><span class="line">NM_CONTROLLED=no</span><br><span class="line">BONDING_OPTS=&quot;mode=4 miimon=100 lacp_rate=1&quot;</span><br></pre></td></tr></table></figure>

<h2 id="更改salve物理网卡的配置文件"><a href="#更改salve物理网卡的配置文件" class="headerlink" title="更改salve物理网卡的配置文件"></a>更改salve物理网卡的配置文件</h2><p>例如 网卡 eno1 ， eno2 做成bond 。</p>
<p>vim  &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eno1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eno1</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">ONBOOT=yes</span><br><span class="line">NM_CONTROLLED=no</span><br><span class="line">IPV6INIT=no</span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=yes</span><br></pre></td></tr></table></figure>

<p>vim &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eno2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eno2</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">ONBOOT=yes</span><br><span class="line">NM_CONTROLLED=no</span><br><span class="line">IPV6INIT=no</span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=yes</span><br></pre></td></tr></table></figure>

<p>修改完后重启。</p>
<h2 id="检测bond的状态"><a href="#检测bond的状态" class="headerlink" title="检测bond的状态"></a>检测bond的状态</h2><p>cat &#x2F;proc&#x2F;net&#x2F;bonding&#x2F;bond0</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://www.snel.com/support/setup-lacp-bonding-interface-centos-7/">https://www.snel.com/support/setup-lacp-bonding-interface-centos-7/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/c200e9e5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/c200e9e5/" class="post-title-link" itemprop="url">Ubuntu18.04绑定bond</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-06-01 12:37:07" itemprop="dateCreated datePublished" datetime="2020-06-01T12:37:07+00:00">2020-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/Ubuntu/" itemprop="url" rel="index"><span itemprop="name">Ubuntu</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h1><ol>
<li>sudo 或者 root 权限下操作。</li>
<li>安装 ifenslave 依赖。</li>
<li>加载 bonding 内核模块。</li>
<li>设置好交换机的配置。</li>
<li>设置网卡配置文件。</li>
</ol>
<h1 id="网卡配置"><a href="#网卡配置" class="headerlink" title="网卡配置"></a>网卡配置</h1><p>将网卡 eno1 ， eno2 做成bond。</p>
<p>编辑配置文件 &#x2F;etc&#x2F;netplan&#x2F;xxx.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This file is generated from information provided by</span></span><br><span class="line"><span class="comment"># the datasource.  Changes to it will not persist across an instance.</span></span><br><span class="line"><span class="comment"># To disable cloud-init&#x27;s network configuration capabilities, write a file</span></span><br><span class="line"><span class="comment"># /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:</span></span><br><span class="line"><span class="comment"># network: &#123;config: disabled&#125;</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">eno1:</span></span><br><span class="line">      <span class="attr">addresses:</span> []</span><br><span class="line">      <span class="attr">dhcp4:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">dhcp6:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">eno2:</span></span><br><span class="line">      <span class="attr">addresses:</span> []</span><br><span class="line">      <span class="attr">dhcp4:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">dhcp6:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">bonds:</span></span><br><span class="line">    <span class="attr">bond0:</span></span><br><span class="line">      <span class="attr">interfaces:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">eno1</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">eno2</span></span><br><span class="line">      <span class="attr">addresses:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span><span class="string">/24</span></span><br><span class="line">      <span class="attr">gateway4:</span> <span class="number">78.41</span><span class="number">.207</span><span class="number">.1</span></span><br><span class="line">      <span class="attr">nameservers:</span></span><br><span class="line">        <span class="attr">addresses:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">8.8</span><span class="number">.4</span><span class="number">.4</span></span><br><span class="line">        <span class="attr">search:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">test.com</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer2</span></span><br></pre></td></tr></table></figure>

<p>编辑完配置文件后，通过 netplan apply 生效，重启。</p>
<p>重启完后，检查bond状态。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/net/bonding/bond0</span><br></pre></td></tr></table></figure>

<h2 id="配置文件说明"><a href="#配置文件说明" class="headerlink" title="配置文件说明"></a>配置文件说明</h2><p>关于 mode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Mode 0</span><br><span class="line">balance-rr</span><br><span class="line"></span><br><span class="line">Round-robin policy: Transmit packets in sequential order from the first available slave through the last. This mode provides load balancing and fault tolerance.</span><br><span class="line"></span><br><span class="line">Mode 1</span><br><span class="line">active-backup</span><br><span class="line"></span><br><span class="line">Active-backup policy: Only one slave in the bond is active. A different slave becomes active if, and only if, the active slave fails. The bond’s MAC address is externally visible on only one port (network adapter) to avoid confusing the switch. This mode provides fault tolerance. The primary option affects the behavior of this mode.</span><br><span class="line"></span><br><span class="line">Mode 2</span><br><span class="line">balance-xor</span><br><span class="line"></span><br><span class="line">XOR policy: Transmit based on selectable hashing algorithm. The default policy is a simple source+destination MAC address algorithm. Alternate transmit policies may be selected via the xmit_hash_policy option, described below. This mode provides load balancing and fault tolerance.</span><br><span class="line"></span><br><span class="line">Mode 3</span><br><span class="line">broadcast</span><br><span class="line"></span><br><span class="line">Broadcast policy: transmits everything on all slave interfaces. This mode provides fault tolerance.</span><br><span class="line"></span><br><span class="line">Mode 4</span><br><span class="line">802.3ad</span><br><span class="line"></span><br><span class="line">IEEE 802.3ad Dynamic link aggregation. Creates aggregation groups that share the same speed and duplex settings. Utilizes all slaves in the active aggregator according to the 802.3ad specification.</span><br><span class="line"></span><br><span class="line">Prerequisites:</span><br><span class="line"></span><br><span class="line">Ethtool support in the base drivers for retrieving the speed and duplex of each slave.</span><br><span class="line">A switch that supports IEEE 802.3ad Dynamic link aggregation. Most switches will require some type of configuration to enable 802.3ad mode.</span><br><span class="line">Mode 5</span><br><span class="line">balance-tlb</span><br><span class="line"></span><br><span class="line">Adaptive transmit load balancing: channel bonding that does not require any special switch support. The outgoing traffic is distributed according to the current load (computed relative to the speed) on each slave. Incoming traffic is received by the current slave. If the receiving slave fails, another slave takes over the MAC address of the failed receiving slave.</span><br><span class="line"></span><br><span class="line">Prerequisites:</span><br><span class="line"></span><br><span class="line">Ethtool support in the base drivers for retrieving the speed of each slave.</span><br><span class="line">Mode 6</span><br><span class="line">balance-alb</span><br><span class="line"></span><br><span class="line">Adaptive load balancing: includes balance-tlb plus receive load balancing (rlb) for IPV4 traffic, and does not require any special switch support. The receive load balancing is achieved by ARP negotiation. The bonding driver intercepts the ARP Replies sent by the local system on their way out and overwrites the source hardware address with the unique hardware address of one of the slaves in the bond such that different peers use different hardware addresses for the server.</span><br></pre></td></tr></table></figure>

<p>关于 xmit_hash_policy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">layer2 Uses XOR of hardware MAC addresses to generate the hash. This algorithm will place all traffic to a particular network peer on the same slave.</span><br><span class="line"></span><br><span class="line">layer2+3 Uses XOR of hardware MAC addresses and IP addresses to generate the hash. This algorithm will place all traffic to a particular network peer on the same slave.</span><br><span class="line"></span><br><span class="line">layer3+4 This policy uses upper layer protocol information, when available, to generate the hash. This allows for traffic to a particular network peer to span multiple slaves, although a single connection will not span multiple slaves.</span><br><span class="line"></span><br><span class="line">encap2+3 This policy uses the same formula as layer2+3 but it relies on skb_flow_dissect to obtain the header fields which might result in the use of inner headers if an encapsulation protocol is used.</span><br><span class="line"></span><br><span class="line">encap3+4 This policy uses the same formula as layer3+4 but it relies on skb_flow_dissect to obtain the header fields which might result in the use of inner headers if an encapsulation protocol is used.</span><br><span class="line"></span><br><span class="line">The default value is layer2. This option was added in bonding version 2.6.3. In earlier versions of bonding, this parameter does not exist, and the layer2 policy is the only policy. The layer2+3 value was added for bonding version 3.2.2.</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/UbuntuBonding/">https://help.ubuntu.com/community/UbuntuBonding/</a><br><a target="_blank" rel="noopener" href="https://www.snel.com/support/how-to-set-up-lacp-bonding-on-ubuntu-18-04-with-netplan/">https://www.snel.com/support/how-to-set-up-lacp-bonding-on-ubuntu-18-04-with-netplan/</a><br><a target="_blank" rel="noopener" href="https://www.linuxidc.com/Linux/2013-10/91118.htm">https://www.linuxidc.com/Linux/2013-10/91118.htm</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/4fa08dfd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/4fa08dfd/" class="post-title-link" itemprop="url">Linux下的dm设备</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-06-01 10:41:58" itemprop="dateCreated datePublished" datetime="2020-06-01T10:41:58+00:00">2020-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前在Linux中，看到一些名字为 dm-xx 的设备。<br>其实dm是Device Mapper的缩写，Device Mapper 是 Linux 2.6 内核中提供的一种从逻辑设备到物理设备的映射框架机制，在该机制下，用户可以很方便的根据自己的需要制定实现存储资源的管理策略，当前比较流行的 Linux 下的逻辑卷管理器如 LVM2（Linux Volume Manager 2 version)、EVMS(Enterprise Volume Management System)、dmraid(Device Mapper Raid Tool)等都是基于该机制实现的。</p>
<blockquote>
<p>Device Mapper是Linux操作系统中块设备一级提供的一种主要映射机制，现在已被多数Linux下的逻辑卷管理器所采用。在该机制下，实现用户自定义的存储资源管理策略变得极其方便。理解device mapper所提供的映射机制，也是进一步理解Linux下一些常见逻辑卷管理器实现的基础。</p>
</blockquote>
<h1 id="dm-xx-与-当前设备的对应关系"><a href="#dm-xx-与-当前设备的对应关系" class="headerlink" title="dm-xx 与 当前设备的对应关系"></a>dm-xx 与 当前设备的对应关系</h1><p>使用命令 dmsetup ls 查看，dm后面的数字对应(253,xx)后面的数字。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@mylnx01 ~]# dmsetup <span class="built_in">ls</span> </span><br><span class="line">VolGroup03-LogVol00--PS--user--snapshot (253, 8)</span><br><span class="line">VolGroup00-LogVol00--PS--user--snapshot (253, 2)</span><br><span class="line">VolGroup05-LogVol00     (253, 3)</span><br><span class="line">VolGroup04-LogVol00     (253, 5)</span><br><span class="line">VolGroup05-LogVol00--PS--user--snapshot (253, 4)</span><br><span class="line">VolGroup03-LogVol00     (253, 7)</span><br><span class="line">VolGroup02-LogVol00--PS--user--snapshot (253, 10)</span><br><span class="line">VolGroup02-LogVol00     (253, 9)</span><br><span class="line">VolGroup01-LogVol00     (253, 11)</span><br><span class="line">VolGroup00-LogVol01     (253, 1)</span><br><span class="line">VolGroup04-LogVol00--PS--user--snapshot (253, 6)</span><br><span class="line">VolGroup00-LogVol00     (253, 0)</span><br><span class="line">VolGroup01-LogVol00--PS--user--snapshot (253, 12)</span><br></pre></td></tr></table></figure>

<p>使用 dmsetup info 查看详细信息。</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kerrycode/p/6187148.html">https://www.cnblogs.com/kerrycode/p/6187148.html</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/linux/l-devmapper/index.html">https://www.ibm.com/developerworks/cn/linux/l-devmapper/index.html</a></p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/b0139160/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/b0139160/" class="post-title-link" itemprop="url">Windows挂载NAS故障</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-06-01 06:11:32" itemprop="dateCreated datePublished" datetime="2020-06-01T06:11:32+00:00">2020-06-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Windows-Server/" itemprop="url" rel="index"><span itemprop="name">Windows Server</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>前提条件：</p>
<ol>
<li>windows server已经加域。</li>
<li>该管理员是属于Administrators组下面。</li>
<li>服务器到 NAS 的防火墙已经开通。</li>
<li>采用samba协议连接。</li>
</ol>
<p>端口：</p>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">端口</th>
<th align="center">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="center">TCP</td>
<td align="center">139，445</td>
<td align="center">139(NetBIOS-SSN),445(Microsoft-DS)</td>
</tr>
<tr>
<td align="center">UPD</td>
<td align="center">137,138,139，445</td>
<td align="center">137-138(Nmbd)</td>
</tr>
</tbody></table>
<p>在OS中添加网络映射盘后，到CMD（以管理员身份运行）没有办法访问该映射盘。</p>
<p>程序报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The system cannot find the path specified.</span><br></pre></td></tr></table></figure>

<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>UAC将Administrators组的成员视为标准用户。</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><h2 id="临时解决方法："><a href="#临时解决方法：" class="headerlink" title="临时解决方法："></a>临时解决方法：</h2><p>在管理员模式下执行 net use 重新映射</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use [映射盘符]    \\[<span class="type">NAS</span> <span class="type">IP</span>]\Volume Name  </span><br></pre></td></tr></table></figure>

<h2 id="根治方法："><a href="#根治方法：" class="headerlink" title="根治方法："></a>根治方法：</h2><ol>
<li>单击“ 开始”，在“ 启动程序和文件”框中键入regedit，然后按Enter。</li>
<li>找到并右键单击注册表子项HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System。</li>
<li>点击“ 新建”，然后单击“ DWORD值”。</li>
<li>键入EnableLinkedConnections，然后按Enter。</li>
<li>右键单击EnableLinkedConnections，然后单击“ 修改”。</li>
<li>在“ 数值数据”框中，键入1，然后单击“ 确定”。</li>
<li>退出注册表编辑器，然后重新启动计算机。</li>
</ol>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ee844140(v=ws.10)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/ee844140(v=ws.10)?redirectedfrom=MSDN</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/c3514bfc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/c3514bfc/" class="post-title-link" itemprop="url">RD会话主机120天宽限期已过的临时解决方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-30 22:52:12" itemprop="dateCreated datePublished" datetime="2020-05-30T22:52:12+00:00">2020-05-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Windows-Server/" itemprop="url" rel="index"><span itemprop="name">Windows Server</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>未配置远程桌面会话主机服务器的授权模式</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><ol>
<li>根本原因： 没有配置RD授权服务器的地址与授权模式。</li>
<li>直接原因： 临时License 是120天的宽限期，当前已过期。</li>
</ol>
<h1 id="临时解决方法"><a href="#临时解决方法" class="headerlink" title="临时解决方法"></a>临时解决方法</h1><p>可尝试删除如下注册表</p>
<p>HKEY_LOCAL_MACHINE\Software\Microsoft\MSLicensing</p>
<p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\RCM\Grace Period</p>
<blockquote>
<p>如果无法直接删除，鼠标右键 Grace Period ，选择“权限”，点击“高级”，进“所有者” 选项卡，将所有者改成当前用户，并复选“替换子容器和对象的所有者”后，点击确定。</p>
</blockquote>
<blockquote>
<p>右键 Grace Period ，选择“权限” ， 添加everyone 权限后，将其删除。</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/6e187a73/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/6e187a73/" class="post-title-link" itemprop="url">Linux下dmidecode命令获取硬件信息</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-30 21:44:32" itemprop="dateCreated datePublished" datetime="2020-05-30T21:44:32+00:00">2020-05-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="dmidecode"><a href="#dmidecode" class="headerlink" title="dmidecode"></a>dmidecode</h1><p>dmidecode在 Linux 系统下获取有关硬件方面的信息。dmidecode 遵循 SMBIOS&#x2F;DMI 标准，以一种可读的方式dump出机器的DMI(Desktop Management Interface)信息, 其输出的信息包括 BIOS、系统、主板、处理器、内存、缓存等等, 既可以得到当前的配置，也可以得到系统支持的最大配置，比如说支持的最大内存数等。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Debian/Ubuntu</span></span><br><span class="line">aptitude install dmidecode</span><br><span class="line"><span class="comment"># Fedora</span></span><br><span class="line">yum installl dmidecode</span><br><span class="line"><span class="comment"># Arch Linux</span></span><br><span class="line">pacman -S dmidecode</span><br><span class="line"><span class="comment"># Gentoo</span></span><br><span class="line">emerge -av dmidecode</span><br></pre></td></tr></table></figure>

<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、查看内存槽数、那个槽位插了内存，大小是多少</span></span><br><span class="line">dmidecode|grep -P -A5 <span class="string">&quot;Memory\s+Device&quot;</span>|grep Size|grep -v Range</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、查看最大支持内存数</span></span><br><span class="line"></span><br><span class="line">dmidecode|grep -P <span class="string">&#x27;Maximum\s+Capacity&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3、查看槽位上内存的速率，没插就是unknown。</span></span><br><span class="line"></span><br><span class="line">dmidecode|grep -A16 <span class="string">&quot;Memory Device&quot;</span>|grep <span class="string">&#x27;Speed&#x27;</span></span><br></pre></td></tr></table></figure>

<p>输出格式：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Handle 0×0002</span><br><span class="line">DMI <span class="built_in">type</span> 2, 8 bytes</span><br><span class="line">Base Board Information</span><br><span class="line">Manufacturer:Intel</span><br><span class="line">Product Name: C440GX+</span><br><span class="line">Version: 727281-0001</span><br><span class="line">Serial Number: INCY92700942</span><br></pre></td></tr></table></figure>

<ol>
<li>recode id(handle): DMI表中的记录标识符，这是唯一的,比如上例中的Handle 0×0002。</li>
<li>dmi type id: 记录的类型，譬如说:BIOS，Memory，上例是type 2，即”Base Board Information”</li>
<li>recode size: DMI表中对应记录的大小，上例为8 bytes.（不包括文本信息，所有实际输出的内容比这个size要更大。）<br>记录头之后就是记录的值：</li>
<li>decoded values: 记录值可以是多行的，比如上例显示了主板的制造商(manufacturer)、model、version以及serial Number。</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最简单的的显示全部dmi信息：</span></span><br><span class="line"><span class="comment">#这样将输出所有的dmi信息，你可能会被一大堆的信息吓坏，通常可以使用下面的方法。</span></span><br><span class="line">dmidecode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.更精简的信息显示：</span></span><br><span class="line"><span class="comment"># -q(–quite) 只显示必要的信息，这个很管用哦。</span></span><br><span class="line"></span><br><span class="line">dmidecode -q</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.显示指定类型的信息：</span></span><br><span class="line"><span class="comment"># 通常我只想查看某类型，比如CPU，内存或者磁盘的信息而不是全部的。这可以使用-t(–type TYPE)来指定信息类型：</span></span><br><span class="line"><span class="comment"># (显示bios和processor)</span></span><br><span class="line">dmidecode -t 0,4 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 通过关键字查询信息</span></span><br><span class="line">dmidecode -s system-serial-number</span><br><span class="line"><span class="comment">#-s (–string keyword)支持的keyword包括：bios-vendor,bios-version, bios-release-date,system-manufacturer, system-product-name, system-version, system-serial-number,baseboard-manu-facturer,baseboard-product-name, baseboard-version, baseboard-serial-number, baseboard-asset-tag,chassis-manufacturer, chas-sis-version, chassis-serial-number, chassis-asset-tag,processor-manufacturer, processor-version.</span></span><br></pre></td></tr></table></figure>

<p>Type Information</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">0 BIOS</span><br><span class="line">1 System</span><br><span class="line">2 Base Board</span><br><span class="line">3 Chassis</span><br><span class="line">4 Processor</span><br><span class="line">5 Memory Controller</span><br><span class="line">6 Memory Module</span><br><span class="line">7 Cache</span><br><span class="line">8 Port Connector</span><br><span class="line">9 System Slots</span><br><span class="line">10 On Board Devices</span><br><span class="line">11 OEM Strings</span><br><span class="line">12 System Configuration Options</span><br><span class="line">13 BIOS Language</span><br><span class="line">14 Group Associations</span><br><span class="line">15 System Event Log</span><br><span class="line">16 Physical Memory Array</span><br><span class="line">17 Memory Device</span><br><span class="line">18 32-bit Memory Error</span><br><span class="line">19 Memory Array Mapped Address</span><br><span class="line">20 Memory Device Mapped Address</span><br><span class="line">21 Built-in Pointing Device</span><br><span class="line">22 Portable Battery</span><br><span class="line">23 System Reset</span><br><span class="line">24 Hardware Security</span><br><span class="line">25 System Power Controls</span><br><span class="line">26 Voltage Probe</span><br><span class="line">27 Cooling Device</span><br><span class="line">28 Temperature Probe</span><br><span class="line">29 Electrical Current Probe</span><br><span class="line">30 Out-of-band Remote Access</span><br><span class="line">31 Boot Integrity Services</span><br><span class="line">32 System Boot</span><br><span class="line">33 64-bit Memory Error</span><br><span class="line">34 Management Device</span><br><span class="line">35 Management Device Component</span><br><span class="line">36 Management Device Threshold Data</span><br><span class="line">37 Memory Channel</span><br><span class="line">38 IPMI Device</span><br><span class="line">39 Power Supply</span><br></pre></td></tr></table></figure>

<h1 id="实例：-查看当前服务器支持可扩容的内存"><a href="#实例：-查看当前服务器支持可扩容的内存" class="headerlink" title="实例： 查看当前服务器支持可扩容的内存"></a>实例： 查看当前服务器支持可扩容的内存</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前内存大小</span></span><br><span class="line">free </span><br><span class="line"><span class="built_in">cat</span> /proc/meminfo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用dmidecode</span></span><br><span class="line">dmidecode -t 16 | grep Maximum</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看内存插槽</span></span><br><span class="line">dmidecode -t 17</span><br><span class="line">dmidecode -t 17 | grep Size</span><br><span class="line"><span class="comment"># 如果Size为No Module Installed 表示该插槽当前未有插入内存。</span></span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="http://www.ttlsa.com/linux/the-linux-dmidecode-command-to-get-the-hardware-information/">http://www.ttlsa.com/linux/the-linux-dmidecode-command-to-get-the-hardware-information/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/704f48d4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/704f48d4/" class="post-title-link" itemprop="url">Linux下的阵列卡工具</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-05-30 21:19:42" itemprop="dateCreated datePublished" datetime="2020-05-30T21:19:42+00:00">2020-05-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h1><p>对已经做了磁盘阵列的服务器，需要在OS层查看阵列状态信息，如硬件的健康状态、阵列等级……</p>
<p>对于Linux，可以使用MegaCli这个工具。</p>
<h1 id="MegaCli-介绍"><a href="#MegaCli-介绍" class="headerlink" title="MegaCli 介绍"></a>MegaCli 介绍</h1><p>MegaCli是一款管理维护硬件RAID软件，可以通过它来了解当前raid卡的所有信息，包括 raid卡的型号，raid的阵列类型，raid 上各磁盘状态。</p>
<p>这个工具有Linux和Windows两个版本。本文先看Linux下的使用方式。</p>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>如果是通过Linux自身查看：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看软件RAID</span></span><br><span class="line"><span class="built_in">cat</span>  /proc/mdstat</span><br><span class="line"><span class="comment"># 查看硬件RAID：查看RAID的厂家、型号、级别</span></span><br><span class="line">dmesg | grep -i raid</span><br><span class="line"><span class="built_in">cat</span> /proc/scsi/scsi</span><br></pre></td></tr></table></figure>

<p>通过 MegaCli：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 【查raid级别】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -LDInfo -Lall -aALL </span><br><span class="line"><span class="comment"># 【查raid卡信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpAllInfo -aALL</span><br><span class="line"><span class="comment"># 查看【硬盘信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -PDList -aALL </span><br><span class="line"><span class="comment">#  【查看电池信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpBbuCmd -aAll</span><br><span class="line"><span class="comment"># 【查看raid卡日志】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -FwTermLog -Dsply -aALL </span><br><span class="line"><span class="comment"># 【显示适配器个数】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -adpCount </span><br><span class="line"><span class="comment"># 【显示适配器时间】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpGetTime –aALL</span><br><span class="line"><span class="comment">#  【显示所有适配器信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpAllInfo -aAll </span><br><span class="line"><span class="comment">#  【显示所有逻辑磁盘组信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -LDInfo -LALL -aAll</span><br><span class="line"><span class="comment"># 【显示所有的物理信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -PDList -aAll </span><br><span class="line"><span class="comment"># 【查看充电状态】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpBbuCmd -GetBbuStatus -aALL |grep ‘Charger Status’ </span><br><span class="line"><span class="comment">#【显示BBU状态信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpBbuCmd -GetBbuStatus -aALL</span><br><span class="line"><span class="comment"># 【显示BBU容量信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpBbuCmd -GetBbuCapacityInfo -aALL</span><br><span class="line"><span class="comment"># 【显示BBU设计参数】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpBbuCmd -GetBbuDesignInfo -aALL </span><br><span class="line"><span class="comment"># 【显示当前BBU属性】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -AdpBbuCmd -GetBbuProperties -aALL </span><br><span class="line"><span class="comment"># 【显示Raid卡型号，Raid设置，Disk相关信息】</span></span><br><span class="line">/opt/MegaRAID/MegaCli/MegaCli64 -cfgdsply -aALL </span><br></pre></td></tr></table></figure>

<p>这个软件貌似支持从系统层做RAID，但我们一般都在服务器的BIOS设置，这里的命令仅做记录，并没有验证：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#6.创建一个 raid5 阵列，由物理盘 2,3,4 构成，该阵列的热备盘是物理盘 5</span></span><br><span class="line">/opt/MegaCli -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct -Hsp[1:5] -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#7.创建阵列，不指定热备</span></span><br><span class="line">/opt/MegaCli -CfgLdAdd -r5 [1:2,1:3,1:4] WB Direct -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#8.删除阵列</span></span><br><span class="line">/opt/MegaCli -CfgLdDel -L1 -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#9.在线添加磁盘</span></span><br><span class="line">/opt/MegaCli -LDRecon -Start -r5 -Add -PhysDrv[1:4] -L1 -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#10.阵列创建完后，会有一个初始化同步块的过程，可以看看其进度。</span></span><br><span class="line">/opt/MegaCli -LDInit -ShowProg -LALL -aALL</span><br><span class="line"></span><br><span class="line"><span class="comment">#或者以动态可视化文字界面显示</span></span><br><span class="line">/opt/MegaCli -LDInit -ProgDsply -LALL -aALL</span><br><span class="line"></span><br><span class="line"><span class="comment">#11.查看阵列后台初始化进度</span></span><br><span class="line">/opt/MegaCli -LDBI -ShowProg -LALL -aALL</span><br><span class="line"></span><br><span class="line"><span class="comment">#或者以动态可视化文字界面显示</span></span><br><span class="line">/opt/MegaCli -LDBI -ProgDsply -LALL -aALL</span><br><span class="line"></span><br><span class="line"><span class="comment">#12.指定第 5 块盘作为全局热备</span></span><br><span class="line">/opt/MegaCli -PDHSP -Set [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#13.指定为某个阵列的专用热备</span></span><br><span class="line">/opt/MegaCli -PDHSP -Set [-Dedicated [-Array1]] [-EnclAffinity] [-nonRevertible] -PhysDrv[1:5] -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#14.删除全局热备</span></span><br><span class="line">/opt/MegaCli -PDHSP -Rmv -PhysDrv[1:5] -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#15.将某块物理盘下线/上线</span></span><br><span class="line">/opt/MegaCli -PDOffline -PhysDrv [1:4] -a0</span><br><span class="line">/opt/MegaCli -PDOnline -PhysDrv [1:4] -a0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 16.查看物理磁盘重建进度</span></span><br><span class="line">/opt/MegaCli -PDRbld -ShowProg -PhysDrv [1:5] -a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#或者以动态可视化文字界面显示</span></span><br><span class="line">/opt/MegaCli -PDRbld -ProgDsply -PhysDrv [1:5] -a0</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://blog.51cto.com/hmtk520/2140657">https://blog.51cto.com/hmtk520/2140657</a><br><a target="_blank" rel="noopener" href="http://www.ttlsa.com/tools/megacli-tool-query-raid-status/">http://www.ttlsa.com/tools/megacli-tool-query-raid-status/</a><br>下载地址：<a target="_blank" rel="noopener" href="https://www.broadcom.com/site-search?q=megacli">https://www.broadcom.com/site-search?q=megacli</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/24/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><span class="page-number current">25</span><a class="page-number" href="/page/26/">26</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/26/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Rohman.Zhu</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
