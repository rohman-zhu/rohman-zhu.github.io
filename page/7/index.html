<!DOCTYPE html>
<html lang="zh_cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"github.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="诺曼实验室">
<meta property="og:url" content="http://github.com/rohman-zhu/page/7/index.html">
<meta property="og:site_name" content="诺曼实验室">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Rohman.Zhu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://github.com/rohman-zhu/page/7/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh_cn","comments":"","permalink":"","path":"page/7/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>诺曼实验室</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">诺曼实验室</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Rohman.Zhu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">438</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">145</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/4abed311/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/4abed311/" class="post-title-link" itemprop="url">ESXI 安装ipmitools</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-02-05 00:12:25" itemprop="dateCreated datePublished" datetime="2024-02-05T00:12:25+00:00">2024-02-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:47" itemprop="dateModified" datetime="2024-12-22T05:27:47+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/" itemprop="url" rel="index"><span itemprop="name">VMware</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/vSphere/" itemprop="url" rel="index"><span itemprop="name">vSphere</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="下载ipmitool-esxi-vib软件"><a href="#下载ipmitool-esxi-vib软件" class="headerlink" title="下载ipmitool-esxi-vib软件"></a>下载ipmitool-esxi-vib软件</h1><p><a target="_blank" rel="noopener" href="https://vswitchzero.files.wordpress.com/2019/08/ipmitool-esxi-vib-1.8.11-2.zip">https://vswitchzero.files.wordpress.com/2019/08/ipmitool-esxi-vib-1.8.11-2.zip</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MD5值核验</span></span><br><span class="line">ipmitool-esxi-vib-1.8.11-2.zip = 444af4ce1dc68418583dba2926093980</span><br><span class="line">ipmitool-1.8.11-2-offline_bundle.zip = 44cb77cc8bd7f969b8e74eb33aec8d71</span><br><span class="line">ipmitool-1.8.11-2.x86_64.vib = 173db5b9f205d9c10d9458ff76d8954b</span><br></pre></td></tr></table></figure>

<h1 id="上传VIB文件并安装"><a href="#上传VIB文件并安装" class="headerlink" title="上传VIB文件并安装"></a>上传VIB文件并安装</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改安装许可级别</span></span><br><span class="line">esxcli software acceptance <span class="built_in">set</span> --level=CommunitySupported</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装软件</span></span><br><span class="line">esxcli software vib install -v /tmp/ipmitool-1.8.11-2.x86_64.vib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行ipmitool指令</span></span><br><span class="line">/opt/ipmitool/ipmitool</span><br><span class="line"></span><br><span class="line"><span class="comment"># 卸载ipmitool指令</span></span><br><span class="line">esxcli software vib remove -n ipmitool</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://vswitchzero.com/ipmitool-vib/">https://vswitchzero.com/ipmitool-vib/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/7df976fa/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/7df976fa/" class="post-title-link" itemprop="url">关闭VCLS虚拟机</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-11-15 00:08:09" itemprop="dateCreated datePublished" datetime="2023-11-15T00:08:09+00:00">2023-11-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/" itemprop="url" rel="index"><span itemprop="name">VMware</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/vSphere/" itemprop="url" rel="index"><span itemprop="name">vSphere</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="需求描述"><a href="#需求描述" class="headerlink" title="需求描述"></a>需求描述</h1><p>从 vSphere 7 开始，集群中会部署vCLS虚拟机用于集群管理；但是vCLS虚拟机需要检查ESXi主机的BIOS设置，CPU选项需要开启“MWAIT”选项。<br>如果没有开启，则vCLS虚拟机会无法启动，而vCenter会一直尝试部署开机；</p>
<p>因此短期需要关闭vCLS部署；长期来看，需要开启底层BIOS设置；</p>
<blockquote>
<p>Monitor 指令：MONITOR EAX, ECX, EDX；设置硬件要监视的线性地址范围，并激活监视器。地址范围应该是写回内存缓存型。</p>
</blockquote>
<blockquote>
<p>Mwait指令：MwAIT EAX, ECX；这是一个提示，允许处理器停止指令执行，并进入取决于具体版本的优化状态，直到发生某类事件。</p>
</blockquote>
<h1 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h1><ol>
<li>登录 vCenter Client；</li>
<li>选中集群，会在URL中看到集群域ID，类似于 domain-c<number>；</li>
<li>进入vCenter配置选项；</li>
<li>进入高级配置选项；点击编辑设置；</li>
<li>添加参数  config.vcls.clusters.domain-c<number>.enabled 且值为 False 的新条目；</li>
<li>保存退出即可；</li>
</ol>
<blockquote>
<p>设置完后，vCLS 监控服务将启动 vCLS 虚拟机的清理，用户将开始看到删除虚拟机的任务。<br>如果此集群启用了 DRS，则它将不起作用，并会在集群摘要中显示额外的警告。在此集群上重新启用 vCLS 之前，DRS 将一直处于禁用状态。<br>要从集群中移除撤回模式，请在上面的步骤 5 中将值更改为 True。 </p>
</blockquote>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/80472?lang=zh_CN">https://kb.vmware.com/s/article/80472?lang=zh_CN</a><br>Mwait设置： <a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/zh/knowledge/EKB1100006339">https://support.huawei.com/enterprise/zh/knowledge/EKB1100006339</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/e3237ebb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/e3237ebb/" class="post-title-link" itemprop="url">常用Python脚本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-11-09 00:07:43" itemprop="dateCreated datePublished" datetime="2023-11-09T00:07:43+00:00">2023-11-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">基础知识</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E7%BC%96%E7%A8%8B/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (判断语句):</span><br><span class="line">    执行条件</span><br></pre></td></tr></table></figure>

<blockquote>
<p>没有{}，没有; ，注意缩进格式，注意: 。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">含义</th>
<th align="center">符号</th>
</tr>
</thead>
<tbody><tr>
<td align="center">大于</td>
<td align="center">&gt;</td>
</tr>
<tr>
<td align="center">小于</td>
<td align="center">&lt;</td>
</tr>
<tr>
<td align="center">大于等于</td>
<td align="center">&gt;&#x3D;</td>
</tr>
<tr>
<td align="center">小于等于</td>
<td align="center">&lt;&#x3D;</td>
</tr>
<tr>
<td align="center">赋值</td>
<td align="center">&#x3D;</td>
</tr>
<tr>
<td align="center">相等</td>
<td align="center">&#x3D;&#x3D;</td>
</tr>
<tr>
<td align="center">不等</td>
<td align="center">!&#x3D;</td>
</tr>
<tr>
<td align="center">相等(对象)</td>
<td align="center">is</td>
</tr>
<tr>
<td align="center">不等(对象)</td>
<td align="center">is not</td>
</tr>
<tr>
<td align="center">逻辑非</td>
<td align="center">not</td>
</tr>
<tr>
<td align="center">逻辑与</td>
<td align="center">and</td>
</tr>
<tr>
<td align="center">逻辑或</td>
<td align="center">or</td>
</tr>
<tr>
<td align="center">位运算 或</td>
<td align="center">|</td>
</tr>
<tr>
<td align="center">位运算 异或</td>
<td align="center">^</td>
</tr>
<tr>
<td align="center">位运算 与</td>
<td align="center">&amp;</td>
</tr>
</tbody></table>
<h1 id="函数体"><a href="#函数体" class="headerlink" title="函数体"></a>函数体</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">函数名</span>(<span class="params">形参</span>):</span><br><span class="line">    函数体</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">函数名(实参)</span><br></pre></td></tr></table></figure>

<h1 id="逐行读取文本"><a href="#逐行读取文本" class="headerlink" title="逐行读取文本"></a>逐行读取文本</h1><blockquote>
<p>节省内存,但会比较慢</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FILE = Open(<span class="string">&#x27;文件绝对路径‘)</span></span><br><span class="line"><span class="string">LINE = FILE.readline()</span></span><br><span class="line"><span class="string">while LINE:</span></span><br><span class="line"><span class="string">    print(LINE)</span></span><br><span class="line"><span class="string">    LINE = FILE.readline()</span></span><br><span class="line"><span class="string">FILE.close()</span></span><br></pre></td></tr></table></figure>

<p>参考 ： <a target="_blank" rel="noopener" href="https://www.cnblogs.com/Kingfan1993/p/9570079.html">https://www.cnblogs.com/Kingfan1993/p/9570079.html</a></p>
<h1 id="字符串分割"><a href="#字符串分割" class="headerlink" title="字符串分割"></a>字符串分割</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;world;world2;word&quot;</span></span><br><span class="line">stringSet=string.split(<span class="string">&quot;;&quot;</span>)</span><br><span class="line">stringSet[<span class="number">0</span>]</span><br><span class="line">stringSet[<span class="number">1</span>]</span><br><span class="line">stringSet[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h1 id="字符型与整型转化"><a href="#字符型与整型转化" class="headerlink" title="字符型与整型转化"></a>字符型与整型转化</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">num_str=<span class="string">&quot;123&quot;</span></span><br><span class="line">num_int=<span class="built_in">int</span>(num_str)</span><br><span class="line"></span><br><span class="line">num_str=<span class="built_in">str</span>(num_int)</span><br></pre></td></tr></table></figure>

<h1 id="时延函数"><a href="#时延函数" class="headerlink" title="时延函数"></a>时延函数</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time.sleep(秒)</span><br></pre></td></tr></table></figure>

<h1 id="其他规则"><a href="#其他规则" class="headerlink" title="其他规则"></a>其他规则</h1><ol>
<li>Python严格区分大小写</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/bff72bb5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/bff72bb5/" class="post-title-link" itemprop="url">vCenter中迁移按钮是灰色状态</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-11-06 23:56:57" itemprop="dateCreated datePublished" datetime="2023-11-06T23:56:57+00:00">2023-11-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%85%E9%9A%9C/" itemprop="url" rel="index"><span itemprop="name">故障</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%85%E9%9A%9C/KB/" itemprop="url" rel="index"><span itemprop="name">KB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>虚拟机在vCenter中无法做vMotion，迁移按钮是灰色状态；</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>虚拟机因为备份而被锁定，导致无法执行迁移操作；</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>需要进入vCenter的PG数据库，将对应条目删除；</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行前，先对vCenter进行快照备份！！！！</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录 VCSA 的SSH Shell；</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭vpxd服务</span></span><br><span class="line">service-control --stop vmware-vpxd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 登录 PG 数据库</span></span><br><span class="line">/opt/vmware/vpostgres/current/bin/psql -d VCDB -U postgres</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询目标虚拟机的VM-ID</span></span><br><span class="line"><span class="comment"># 语句：select * from VPX_VM WHERE FILE_NAME LIKE &#x27;%Virtual_Machine_Name%&#x27;;</span></span><br><span class="line"><span class="comment"># 比如</span></span><br><span class="line"><span class="keyword">select</span> * from VPX_VM WHERE FILE_NAME LIKE <span class="string">&#x27;%[rohmanvm]%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取到虚拟机的ID</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取虚拟机执行的条目</span></span><br><span class="line"><span class="keyword">select</span> * from VPX_DISABLED_METHODS WHERE ENTITY_MO_ID_VAL = <span class="string">&#x27;vm-[ID编码]&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除编码</span></span><br><span class="line">delete from VPX_DISABLED_METHODS WHERE ENTITY_MO_ID_VAL = <span class="string">&#x27;vm-[ID编码]&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动vCenter服务</span></span><br><span class="line">service-control --start vmware-vpxd</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/1029926?lang=zh_CN">https://kb.vmware.com/s/article/1029926?lang=zh_CN</a></p>
<p><a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/2044369">https://kb.vmware.com/s/article/2044369</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/c874c882/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/c874c882/" class="post-title-link" itemprop="url">UAG没有初始化配置9443管理端口</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-11-05 17:13:17" itemprop="dateCreated datePublished" datetime="2023-11-05T17:13:17+00:00">2023-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%85%E9%9A%9C/" itemprop="url" rel="index"><span itemprop="name">故障</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>导入OVF镜像后，UAG在初始化后竟然无法访问9443端口的控制台；</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>配置 OVF 没有配置 RESET 密码，导致UAG没有初始化完毕；</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/991119f8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/991119f8/" class="post-title-link" itemprop="url">Horizon CORS 配置-kb85801</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-11-05 17:03:11" itemprop="dateCreated datePublished" datetime="2023-11-05T17:03:11+00:00">2023-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:47" itemprop="dateModified" datetime="2024-12-22T05:27:47+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/KB/" itemprop="url" rel="index"><span itemprop="name">KB</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><ul>
<li>Horizon 从 6.2.1 开始，checkOrigin 属性默认为enabled；</li>
<li>从 8.3 ， 2106 开始，enableCORS默认为enabled；</li>
<li>从 2111.1 开始，allowUnexpectedHost 默认为enabled；</li>
<li>从 2111.2 开始，allowUnexpectedHost 默认为disabled；</li>
</ul>
<h1 id="原文"><a href="#原文" class="headerlink" title="原文"></a>原文</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Horizon  2111.2, 2209.1, 2212.1 and 2306:</span><br><span class="line">Cross-Origin Resource Sharing (CORS) is enabled by default. See Cross-Origin Resource Sharing.</span><br><span class="line">Security configuration setting balancedHost can now accept a list for those with more than one load balancer. The syntax is exactly the same as portalHost. (Release Notes ) </span><br><span class="line">​​​​​​Security configuration setting allowUnexpectedHost has changed from true to false. </span><br><span class="line">This means that connections using the name or IP address of a proxy, gateway or load balancer that is not defined in locked.properties will fail, even if checkOrigin and enableCORS are both set to false.</span><br><span class="line">Please see Error 421 while connecting to Horizon via HTML Web Console after an upgrade to 2306,2111.1 or Later (93915) for additional details.</span><br><span class="line">For a step-by-step walkthrough of configuring Locked.properties, please see Horizon Server: Troubleshooting Configuration Issues with Locked.properties(94578)</span><br><span class="line">This Article&#x27;s purpose is to outline some common questions seen as a result of these changes.</span><br><span class="line"></span><br><span class="line">Potential Symptoms seen as a result of the change:</span><br><span class="line"> HTML access is stuck in the &quot;Waiting&quot; screen due to the lack of configuration in &quot;locked.properties&quot; </span><br><span class="line">An alert appears on an HTML5 access attempt &quot;Failed to connect to the Horizon Connection Server&quot;</span><br><span class="line">Solution</span><br><span class="line">Common Questions: </span><br><span class="line"></span><br><span class="line">1.What is the purpose of this change?</span><br><span class="line"></span><br><span class="line">Any URL the user clicks on needs to be known to the connection server the request reaches.</span><br><span class="line">If they click on badguy.com, and that redirects them to Horizon, we need to reject the request. That’s the purpose of this. This is a W3 standard we comply with, see the documentation on this. CORS allows additional granularity through policy.</span><br><span class="line"></span><br><span class="line">2. Is this not just Origin Checking?</span><br><span class="line">Origin Checking has been a default in Horizon since Horizon 7.6 and this impacted admin page access in the past, please see KB2144768. </span><br><span class="line">Default origins include the connection servers&#x27; localhost and external URL (the external URL defaults to the server FQDN but is typically changed to an FDQN of a VIP used for external access). These are not impacted by the change.</span><br><span class="line">Origin checking is enabled by default. When it is enabled, a request is accepted only without an Origin, or with an Origin equal to the address that the External URL specifies, to the balancedHost address, to any portalHost address, to any chromeExtension hash, to null, or to localhost. If Origin is not one of these possibilities, an &quot;Unexpected Origin&quot; error is logged and a status of 404 is returned. Reference Link </span><br><span class="line"></span><br><span class="line">3. I&#x27;m aware of origin checking, what do I need to consider?</span><br><span class="line"></span><br><span class="line">This enhancement can impact an environment in terms of HTML5 access when load balancers are in the equation.</span><br><span class="line"></span><br><span class="line">Origin Header:  The origin header is the value that will pass through for validation by the connection server and can be defined as the URL that the user clicks on.</span><br><span class="line"></span><br><span class="line">Example: </span><br><span class="line">User opens htttps:/loadbalancer/ and logs into Horizon, hitting enter to authenticate.</span><br><span class="line">This request will be rejected if this load balancer URL does not match the aforementioned defaults.</span><br><span class="line"></span><br><span class="line">4. I&#x27;m experiencing issues with html5 page access after an update to 2106 and worked fine with previous release , what are my options?</span><br><span class="line"></span><br><span class="line">Essentially a configuration or design change is potentially needed based on your individual circumstances.</span><br><span class="line">UAG has a feature to rewrite the origin header coming from the client to match the URL it is using to forward requests to the connection server. (documentation  - Re-Write Origin Header).  This feature is off by default but can help to reduce the list of entries or even obviate the need for locked.properties entirely.</span><br><span class="line">If the URL that your users connect with will need to be added to the known origins list for each connection server behind the load balancer which is contained within locked.properties</span><br><span class="line"> </span><br><span class="line">4. How do I edit locked.properties?</span><br><span class="line"></span><br><span class="line">   1. Create or edit the locked.properties file. This is located on each connection server in     c:\program files\vmware\VMware View\Server\sslgateway\conf.</span><br><span class="line">   2. This file can be edited with a standard text editor, like Notepad.</span><br><span class="line">   3. Please validate the extension of the file to ensure it is saved as .properties. If saved as a .txt extension, the edited values will not be read.</span><br><span class="line">   4. Restart each server to ensure the values take effect.</span><br><span class="line"></span><br><span class="line">5. What values  do I need to change in locked.properties?</span><br><span class="line">  </span><br><span class="line"> There are two keywords for extending the known origins list, balancedHost and portalHost.</span><br><span class="line">Note 1: You don’t set a URL on these, just the hostname.</span><br><span class="line">Note 2: Both are designed to extend the list of known origins.</span><br><span class="line"></span><br><span class="line">For a hypothetical load balancer, we need to add this entry to all connection servers behind it:</span><br><span class="line">balancedHost = loadbalandedviewurl.company.com</span><br><span class="line">There can only be one entry for balancedHost and only https is allowed.</span><br><span class="line">The purpose of balanced host is primarily for the load balancer between connection servers and internal clients.</span><br><span class="line">There is no limit on the amount of portal host entries</span><br><span class="line"></span><br><span class="line">The purpose of portalHost is primarily for alternative routes and names.</span><br><span class="line"></span><br><span class="line">For example, let’s say that there are more routes into the environment, through originalname.com  and newname.net and internally through originalname.int or hostname.</span><br><span class="line"></span><br><span class="line">You’ll need to add portalHost entries for these:</span><br><span class="line"></span><br><span class="line">portalHost.1 = originalname.com</span><br><span class="line">portalHost.2 = newname.net</span><br><span class="line">portalHost.3 = originalname.int</span><br><span class="line">portalHost.4 = originalname</span><br><span class="line">portalHost.5 = hostname</span><br><span class="line"></span><br><span class="line">If all of these are load balancers too, You can reduce complexity and stop using balancedHost and list all routes with portalHost entries.</span><br><span class="line"></span><br><span class="line">5.  Are these failures tracked in logs?</span><br><span class="line">Yes, If a request comes in with an origin header that is not in the list of known origins, you will get the error in the debug log of the connection server with a line: &quot;Unexpected origin”.</span><br><span class="line"></span><br><span class="line">Log file Location: C:\ProgramData\VMware\VDM\logs</span><br><span class="line">Log file name: debug-datetime.txt</span><br><span class="line"></span><br><span class="line">It you note the time of the failed attempt or check the debug log that most closely matches the time of the reported test.</span><br><span class="line"></span><br><span class="line">Sample Log Line :</span><br><span class="line">2021-09-24T22:05:34.737-07:00 ERROR (1B08-1A58) &lt;SimpleDeamonThread&gt; [h] (ajp:admin:Request190) Unexpected Origin: https://newname.net</span><br><span class="line">2021-09-24T22:05:34.738-07:00 DEBUG (1B08-1A58) &lt;SimpleDeamonThread&gt; [v] (ajp:admin:Request190) Response 404 Not Found [close]</span><br><span class="line"></span><br><span class="line">It then tells you what the origin header looks like, and if this should be accepted you can add yet another portalHost entry, for instance, with the above example - newname.net needs to be added as a portalhost entry.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p><a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/85801">https://kb.vmware.com/s/article/85801</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/345f1997/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/345f1997/" class="post-title-link" itemprop="url">VMware Horizon 提示没有可用的显示协议</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-11-05 16:38:08" itemprop="dateCreated datePublished" datetime="2023-11-05T16:38:08+00:00">2023-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%85%E9%9A%9C/" itemprop="url" rel="index"><span itemprop="name">故障</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>关键节点：UAG、连接服务器、RDSH服务器；</p>
<p>显示协议：Blast；</p>
<p>客户端节点提示，无可用显示协议或者 Internal Server Error；<br>UAG与RDSH服务器网络链路正常，TCP-22443端口是联通的；</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>RDSH服务器上面的22443端口不是VMware View Agent进程监听的，而是其他应用程序在监听，导致客户端无法使用 Blast 协议安装；</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>检测端口监听的进程：</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -a:--all，显示所有链接和监听端口</span></span><br><span class="line"><span class="comment"># -b:显示包含于创建每个连接或监听端口的可执行组件。在某些情况下已知可执行组件拥有多个独立组件，并且在这些情况下包含于创建连接或监听端口的组件序列被显示。这种情况下，可执行组件名在底部的 [] 中，顶部是其调用的组件，等等，直到 TCP/IP 部分。注意此选项可能需要很长时间，如果没有足够权限可能失败。</span></span><br><span class="line">netstat <span class="literal">-ab</span> | findstr <span class="number">22443</span>;</span><br></pre></td></tr></table></figure>

<p>检测 WINRM 监听端口并修改：</p>
<p>观察到 WINRM 的端口被改为 22443 ，导致BLAST协议的进程无法使用此端口；</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查端口</span></span><br><span class="line">winrm enumerate winrm/config/listener</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改端口</span></span><br><span class="line"><span class="built_in">set-item</span> wsman:\localhost\listener\listener*\port <span class="literal">-value</span> <span class="number">8080</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/ed83ffb5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/ed83ffb5/" class="post-title-link" itemprop="url">故障记录-ESXi-Umap紫屏</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-15 20:14:57" itemprop="dateCreated datePublished" datetime="2023-10-15T20:14:57+00:00">2023-10-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:49" itemprop="dateModified" datetime="2024-12-22T05:27:49+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/" itemprop="url" rel="index"><span itemprop="name">VMware</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/vSphere/" itemprop="url" rel="index"><span itemprop="name">vSphere</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>多个ESXi 在未知的情况下，发生资屏，上面的虚拟机发生HA重启；<br>紫屏记录为 “PF Exception 14 in world xxxx ： Unmap Helper IP 0xXXXXXX addr 0x0”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PCPU 0:xxxx</span><br><span class="line">PCPU 64:xxxxx</span><br><span class="line">PCPU 128 :xxxx</span><br><span class="line">Code start : xxx应该是ESXi运行时间</span><br><span class="line">0xXXXXXXX:Res5MemUnlockTxnRCL ist@esx#nover</span><br><span class="line">0xXXXXXXX:J3_DeleteTransacton@esx#nover</span><br><span class="line">0xXXXXXXX:J3_AbortTransaction@esx#nover</span><br><span class="line">0xXXXXXXX:UnmapLockCommon@esx#nover</span><br><span class="line">0xXXXXXXX:UnmapAsyncClusterProcessing@esx#nover</span><br><span class="line">0xXXXXXXX:HelperQueueFunc@vmkernel#nover</span><br><span class="line">0xXXXXXXX:CpuSched_StartWorld@vmernel</span><br></pre></td></tr></table></figure>

<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>底层有一个存储卷有异常，原本工目标Datastore开启了精简置备、去重压缩功能，Datastore上面的虚拟机任何数据变化，则会触发底层Datastore空间回收；<br>现在因为这个卷异常，上面的虚拟机的数据变化，则会触发空间回收，因为空间回收异常，导致ESXi直接紫屏；</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><ol>
<li>关闭ESXi 的空间回收功能；【并不能解决问题,底层空间回收依旧会触发紫屏】</li>
<li>将目标卷上面的虚拟机迁移走。【注意，这个卷上面的操作，都有可能导致ESXi紫屏】</li>
<li>将目标卷卸载并删除；</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/682a790d/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/682a790d/" class="post-title-link" itemprop="url">CHROME-TLS-SHA1更新发布导致无法访问UAG</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-08 00:16:04" itemprop="dateCreated datePublished" datetime="2023-10-08T00:16:04+00:00">2023-10-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-03-18 08:48:44" itemprop="dateModified" datetime="2025-03-18T08:48:44+00:00">2025-03-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/" itemprop="url" rel="index"><span itemprop="name">VMware</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/Horizon-View/" itemprop="url" rel="index"><span itemprop="name">Horizon View</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>Chrome浏览器在117版本中，访问UAG地址（<a target="_blank" rel="noopener" href="https://xxxxxx.com)/">https://xxxxxx.com）</a> 浏览器提示”ERR_SSL_PROTOCOL_ERROR”;但使用其他浏览器，如Safari、Edge、Firefox就可以正常访问；</p>
<p>Chrome版本信息：117.0.5938.150</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><p>服务器端的TLS使用了SHA1加密，导致浏览器判定为异常；</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><h2 id="短期方案"><a href="#短期方案" class="headerlink" title="短期方案"></a>短期方案</h2><p>调整Chrome的配置</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在浏览器地址栏中输入</span></span><br><span class="line">chrome://flags/#use-sha1-server-handshakes</span><br><span class="line"><span class="comment"># 将 Allow SHA-1 server signatures in TLS 调整为 Allow</span></span><br></pre></td></tr></table></figure>

<h2 id="长期方案【待补充】"><a href="#长期方案【待补充】" class="headerlink" title="长期方案【待补充】"></a>长期方案【待补充】</h2><p>需要升级openssl</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 版本查看</span></span><br><span class="line">openssl version</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 2023-10-07</span><br><span class="line">测试过 2306 ，2306-FIPS版本，结果只有普通版的2306版本是正常的，而FIPS版本则无法使用；</span><br><span class="line">可能是FIPS版本，过程有需要SHA-1加密的TLS，导致被Chrome给拦截了，目前还在等待官方信息；</span><br><span class="line"></span><br><span class="line"># 2025-03-18</span><br><span class="line"># euc-unified-access-gateway-23.06.1.0-22332533_OVF10.ova 版本可用，不会出现SSL拦截，使用一年下来，也不会出现根目录用满情况。</span><br></pre></td></tr></table></figure>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>诡异的ERR_SSL_PROTOCOL_ERROR：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/659738295">https://zhuanlan.zhihu.com/p/659738295</a><br>Chromium描述：<a target="_blank" rel="noopener" href="https://bugs.chromium.org/p/chromium/issues/detail?id=1488571">https://bugs.chromium.org/p/chromium/issues/detail?id=1488571</a><br>发布信息：<a target="_blank" rel="noopener" href="https://chromium-review.googlesource.com/c/chromium/src/+/4898836">https://chromium-review.googlesource.com/c/chromium/src/+/4898836</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://github.com/rohman-zhu/posts/9e510a03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Rohman.Zhu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="诺曼实验室">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 诺曼实验室">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/9e510a03/" class="post-title-link" itemprop="url">VSAN-健康检查出现分区故障</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-06 22:20:15" itemprop="dateCreated datePublished" datetime="2023-10-06T22:20:15+00:00">2023-10-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-12-22 05:27:48" itemprop="dateModified" datetime="2024-12-22T05:27:48+00:00">2024-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/" itemprop="url" rel="index"><span itemprop="name">VMware</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/vSphere/" itemprop="url" rel="index"><span itemprop="name">vSphere</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/VMware/vSphere/vSAN/" itemprop="url" rel="index"><span itemprop="name">vSAN</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="故障描述"><a href="#故障描述" class="headerlink" title="故障描述"></a>故障描述</h1><p>vSAN集群的健康检查中，出现分区错误，有一台主机的vSAN分区为2号，其他主机的vSAN分区为1号。</p>
<h1 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h1><ol>
<li>网络异常：vSAN节点之间网络不通；</li>
<li>版本问题：vSAN节点之间版本不一致；</li>
<li>目标主机未开启集群发现；</li>
</ol>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>先确认 vSAN Kernel 网络流量是否正常；</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取 vSAN 网卡信息</span></span><br><span class="line">esxcli vsan network list</span><br><span class="line"><span class="comment"># 获取 IP 配置信息</span></span><br><span class="line">esxcli network ip interface ipv4 get</span><br><span class="line"><span class="comment"># 结合上述信息，确定vSAN用的 vmk 、IP信息；</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发起ping测试</span></span><br><span class="line">ping [目标IP]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定对应网卡发起ping测试</span></span><br><span class="line">vmkping -I [vSAN用的网卡] [目标IP]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>确定网络是否正常，另外MTU也是需要关注的；</p>
</blockquote>
<p>确定磁盘版本是否一致；</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">esxcli system settings advanced list -o /Virsto/DiskFormatVersion</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果磁盘版本不一致，则需要检查ESXi版本是否一致，是否有升级；</p>
</blockquote>
<p>检查分区更新值</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确认成员更新值</span></span><br><span class="line">esxcfg-advcfg -g  /VSAN/IgnoreClusterMemberListupdates</span><br><span class="line"><span class="comment"># 如果值为1，则表示目标主机当前状态为“禁止从 vCenter Server 中更新集群成员”</span></span><br><span class="line"><span class="comment"># 需要重新执行指令：</span></span><br><span class="line">esxcfg-advcfg -s 0 /VSAN/IgnoreClusterMemberListupdates</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>解决VMware vSAN分区故障：<a target="_blank" rel="noopener" href="https://m.fx361.com/news/2018/1106/18285695.html">https://m.fx361.com/news/2018/1106/18285695.html</a><br>如何使用旧格式版本格式化 VSAN 磁盘组 ：<a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/2146221?lang=zh_CN">https://kb.vmware.com/s/article/2146221?lang=zh_CN</a><br>vSAN 运行状况服务 - 网络运行状况 - vSAN 群集分区：<a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/2108011?lang=zh_CN">https://kb.vmware.com/s/article/2108011?lang=zh_CN</a><br>如何处理 VSAN 群集中的隔离&#x2F;分区情形？：<a target="_blank" rel="noopener" href="https://blog.51cto.com/vsdsrevolution/1375800">https://blog.51cto.com/vsdsrevolution/1375800</a><br>Configuring vSAN Unicast networking from the command line (2150303)： <a target="_blank" rel="noopener" href="https://kb.vmware.com/s/article/2150303">https://kb.vmware.com/s/article/2150303</a><br>手动关闭并重新启动 vSAN 集群：<a target="_blank" rel="noopener" href="https://docs.vmware.com/cn/VMware-vSphere/7.0/com.vmware.vsphere.vsan-monitoring.doc/GUID-31B4F958-30A9-4BEC-819E-32A18A685688.html">https://docs.vmware.com/cn/VMware-vSphere/7.0/com.vmware.vsphere.vsan-monitoring.doc/GUID-31B4F958-30A9-4BEC-819E-32A18A685688.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/44/">44</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Rohman.Zhu</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
